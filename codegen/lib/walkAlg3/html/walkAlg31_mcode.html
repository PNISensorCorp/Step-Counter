<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T1U3">walkStruct</span> = walkAlg3(<span class="mxinfo" id="T1:U2"><span class="mxinfo" id="T1:U3"><span class="var type1" id="S2T1U6">walkStruct</span></span></span>,<span class="var type1" id="S3T4U7">accDataIn</span>,<span class="var type1" id="S4T4U8">aRMSin</span>,<span class="var type1" id="S5T3U9">tDataIn</span>,<span class="var type1" id="S6T2U10">whichThr</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">%%% walking algorithm. </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">% Performs step counting primarily targeted for the wrist mounting, uses</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">% maximum observed value for each. Could also be used for accel radii.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">% Inputs: </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6"> 6</a></span><span class="line"><span class="comment">% walkStruct = holds all persistent varibles as well as thresholds, see</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7"> 7</a></span><span class="line"><span class="comment">% stepCounter_struct_init for definitions.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8"> 8</a></span><span class="line"><span class="comment">% accDataIn = accel data inputs, x, y, z; can be lowpass filtered</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9"> 9</a></span><span class="line"><span class="comment">% if desired.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10">10</a></span><span class="line"><span class="comment">% aRMSin = moving average or rms data, subtracted from data. Can input</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11">11</a></span><span class="line"><span class="comment">% zeros, or input RMS data as desired, will require different thresholds.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12">12</a></span><span class="line"><span class="comment">% tDataIn = time data, in milliseconds, relative timing between points is</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13">13</a></span><span class="line"><span class="comment">% all that matters, but must be unwrapped before input to this function.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14">14</a></span><span class="line"><span class="comment">% whichThr = allows user to store two sets of thresholds and switch with</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15">15</a></span><span class="line"><span class="comment">% this value. Example, could use different thresholds for 0 aRMSin vs moving</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16">16</a></span><span class="line"><span class="comment">% standard deviation for aRMSin and switch depending on if data available.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17">17</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18">18</a></span><span class="line"><span class="comment">%#codegen</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19">19</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20">20</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21">21</a></span><span class="line"><span class="comment">% choose a thershold setting </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22">22</a></span><span class="line"><span class="comment">% two threshold settings per to denote high acceleration or low</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23">23</a></span><span class="line"><span class="comment">% acceleration amplitudes</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24">24</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo" id="T8:U9"><span class="var type1" id="S6T2U14">whichThr</span> == <span class="mxinfo" id="T9:U11">2</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25">25</a></span><span class="line">    <span class="mxinfo" id="T2:U12"><span class="var type1" id="S7T2U18">LIth</span> = <span class="mxinfo" id="T2:U14"><span class="var type1" id="S2T1U20">walkStruct</span>.LIthrA</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26">26</a></span><span class="line">    <span class="mxinfo" id="T2:U16"><span class="var type1" id="S8T2U24">HIth</span> = <span class="mxinfo" id="T2:U18"><span class="var type1" id="S2T1U26">walkStruct</span>.HIthrA</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27">27</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28">28</a></span><span class="line">    <span class="mxinfo" id="T2:U20"><span class="var type1" id="S7T2U31">LIth</span> = <span class="mxinfo" id="T2:U22"><span class="var type1" id="S2T1U33">walkStruct</span>.LIthrW</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29">29</a></span><span class="line">    <span class="mxinfo" id="T2:U24"><span class="var type1" id="S8T2U37">HIth</span> = <span class="mxinfo" id="T2:U26"><span class="var type1" id="S2T1U39">walkStruct</span>.HIthrW</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30">30</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31">31</a></span><span class="line"><span class="mxinfo" id="T6:U28"><span class="mxinfo" id="T6:U29"><span class="var type1" id="S2T1U44">walkStruct</span>.addPoint</span> = <span class="mxinfo" id="T6:U31">int8(<span class="mxinfo" id="T9:U32">0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32">32</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33">33</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo" id="T8:U33"><span class="mxinfo" id="T2:U34">max(<span class="mxinfo" id="T4:U35">abs(<span class="mxinfo" id="T4:U36"><span class="var type1" id="S3T4U57">accDataIn</span>-<span class="var type1" id="S4T4U58">aRMSin</span></span>)</span>)</span>&gt;<span class="var type1" id="S7T2U59">LIth</span></span> <span class="comment">% check if data has crossed minimum threshold</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34">34</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo" id="T8:U40">~<span class="mxinfo" id="T5:U41"><span class="var type1" id="S2T1U64">walkStruct</span>.crossed</span></span> <span class="comment">% when it crosses a threshold incremement steps</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35">35</a></span><span class="line">            <span class="mxinfo" id="T3:U43"><span class="mxinfo" id="T3:U44"><span class="var type1" id="S2T1U69">walkStruct</span>.HLI</span> = <span class="mxinfo" id="T3:U46"><span class="mxinfo" id="T3:U47"><span class="var type1" id="S2T1U73">walkStruct</span>.HLI</span> + <span class="mxinfo" id="T3:U49">uint32(<span class="mxinfo" id="T9:U50">1</span>)</span></span></span>; <span class="comment">% step count</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36">36</a></span><span class="line">            <span class="mxinfo" id="T5:U51"><span class="mxinfo" id="T5:U52"><span class="var type1" id="S2T1U81">walkStruct</span>.crossed</span> = <span class="mxinfo" id="T5:U54">uint8(<span class="mxinfo" id="T9:U55">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37">37</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38">38</a></span><span class="line">        <span class="comment">% if newest point is highest current point for this crossing, save</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39">39</a></span><span class="line">        <span class="comment">% it as the current peak data point</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40">40</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo" id="T8:U56"><span class="mxinfo" id="T2:U57">max(<span class="mxinfo" id="T4:U58">abs(<span class="mxinfo" id="T4:U59"><span class="var type1" id="S3T4U94">accDataIn</span>-<span class="var type1" id="S4T4U95">aRMSin</span></span>)</span>)</span> &gt; <span class="mxinfo" id="T2:U62">max(<span class="mxinfo" id="T4:U63">abs(<span class="mxinfo" id="T4:U64"><span class="mxinfo" id="T4:U65"><span class="var type1" id="S2T1U102">walkStruct</span>.Acur</span>-<span class="mxinfo" id="T4:U67"><span class="var type1" id="S2T1U105">walkStruct</span>.AcurRMS</span></span>)</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41">41</a></span><span class="line">            <span class="mxinfo" id="T4:U69"><span class="mxinfo" id="T4:U70"><span class="var type1" id="S2T1U110">walkStruct</span>.Acur</span> = <span class="var type1" id="S3T4U112">accDataIn</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42">42</a></span><span class="line">            <span class="mxinfo" id="T4:U73"><span class="mxinfo" id="T4:U74"><span class="var type1" id="S2T1U116">walkStruct</span>.AcurRMS</span> = <span class="var type1" id="S4T4U118">aRMSin</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43">43</a></span><span class="line">            <span class="mxinfo" id="T3:U77"><span class="mxinfo" id="T3:U78"><span class="var type1" id="S2T1U122">walkStruct</span>.Acurt</span> = <span class="var type1" id="S5T3U124">tDataIn</span></span>;<span class="comment">% time and value</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44">44</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45">45</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46">46</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo" id="T5:U81"><span class="var type1" id="S2T1U129">walkStruct</span>.crossed</span> <span class="comment">% once data crosses back under threshold, perform calculations and determine step type</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47">47</a></span><span class="line">            <span class="mxinfo" id="T6:U83"><span class="mxinfo" id="T6:U84"><span class="var type1" id="S2T1U134">walkStruct</span>.addPoint</span> = <span class="mxinfo" id="T6:U86">int8(<span class="mxinfo" id="T9:U87">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48">48</a></span><span class="line">            <span class="keyword">if</span> <span class="mxinfo" id="T8:U88"><span class="mxinfo" id="T2:U89">max(<span class="mxinfo" id="T4:U90">abs(<span class="mxinfo" id="T4:U91"><span class="mxinfo" id="T4:U92"><span class="var type1" id="S2T1U148">walkStruct</span>.Acur</span>-<span class="mxinfo" id="T4:U94"><span class="var type1" id="S2T1U151">walkStruct</span>.AcurRMS</span></span>)</span>)</span> &gt; <span class="var type1" id="S8T2U153">HIth</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49">49</a></span><span class="line">                <span class="comment">% high impact point classification</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50">50</a></span><span class="line">                <span class="mxinfo" id="T3:U97"><span class="mxinfo" id="T3:U98"><span class="var type1" id="S2T1U157">walkStruct</span>.HIcnt</span> = <span class="mxinfo" id="T3:U100"><span class="mxinfo" id="T3:U101"><span class="var type1" id="S2T1U161">walkStruct</span>.HIcnt</span> + <span class="mxinfo" id="T3:U103">uint32(<span class="mxinfo" id="T9:U104">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51">51</a></span><span class="line">                <span class="mxinfo" id="T3:U105"><span class="mxinfo" id="T3:U106"><span class="var type1" id="S2T1U169">walkStruct</span>.HIt</span> = <span class="mxinfo" id="T3:U108"><span class="mxinfo" id="T3:U109"><span class="var type1" id="S2T1U173">walkStruct</span>.HIt</span> + <span class="mxinfo" id="T3:U111">uint32(<span class="mxinfo" id="T9:U112">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52">52</a></span><span class="line">            <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53">53</a></span><span class="line">                <span class="comment">% low impact point classification</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54">54</a></span><span class="line">                <span class="mxinfo" id="T3:U113"><span class="mxinfo" id="T3:U114"><span class="var type1" id="S2T1U182">walkStruct</span>.LIcnt</span> = <span class="mxinfo" id="T3:U116"><span class="mxinfo" id="T3:U117"><span class="var type1" id="S2T1U186">walkStruct</span>.LIcnt</span> + <span class="mxinfo" id="T3:U119">uint32(<span class="mxinfo" id="T9:U120">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55">55</a></span><span class="line">                <span class="mxinfo" id="T3:U121"><span class="mxinfo" id="T3:U122"><span class="var type1" id="S2T1U194">walkStruct</span>.LIt</span> = <span class="mxinfo" id="T3:U124"><span class="mxinfo" id="T3:U125"><span class="var type1" id="S2T1U198">walkStruct</span>.LIt</span> + <span class="mxinfo" id="T3:U127">uint32(<span class="mxinfo" id="T9:U128">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56">56</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57">57</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58">58</a></span><span class="line">            <span class="keyword">if</span> <span class="mxinfo" id="T8:U129"><span class="mxinfo" id="T3:U130"><span class="var type1" id="S2T1U207">walkStruct</span>.HLI</span> &gt; <span class="mxinfo" id="T9:U132">1</span></span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59">59</a></span><span class="line">                <span class="comment">% remove data points that are too close together in time</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,60" id="srcline60">60</a></span><span class="line">                <span class="keyword">if</span> <span class="mxinfo" id="T8:U133"><span class="mxinfo" id="T3:U134">abs(<span class="mxinfo" id="T3:U135"><span class="mxinfo" id="T3:U136"><span class="var type1" id="S2T1U217">walkStruct</span>.Acurt</span>-<span class="mxinfo" id="T3:U138"><span class="var type1" id="S2T1U220">walkStruct</span>.Aprevt</span></span>)</span> &lt; <span class="mxinfo" id="T2:U140"><span class="var type1" id="S2T1U223">walkStruct</span>.timeThr</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,61" id="srcline61">61</a></span><span class="line">                    <span class="mxinfo" id="T3:U142"><span class="mxinfo" id="T3:U143"><span class="var type1" id="S2T1U228">walkStruct</span>.HLI</span> = <span class="mxinfo" id="T3:U145"><span class="mxinfo" id="T3:U146"><span class="var type1" id="S2T1U232">walkStruct</span>.HLI</span> - <span class="mxinfo" id="T3:U148">uint32(<span class="mxinfo" id="T9:U149">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,62" id="srcline62">62</a></span><span class="line">                    <span class="mxinfo" id="T6:U150"><span class="mxinfo" id="T6:U151"><span class="var type1" id="S2T1U240">walkStruct</span>.addPoint</span> = <span class="mxinfo" id="T6:U153">int8(<span class="mxinfo" id="T9:U154">-1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,63" id="srcline63">63</a></span><span class="line">                    <span class="keyword">if</span> <span class="mxinfo" id="T8:U155"><span class="mxinfo" id="T2:U156">max(<span class="mxinfo" id="T4:U157">abs(<span class="mxinfo" id="T4:U158"><span class="mxinfo" id="T4:U159"><span class="var type1" id="S2T1U255">walkStruct</span>.Aprev</span>-<span class="mxinfo" id="T4:U161"><span class="var type1" id="S2T1U258">walkStruct</span>.AprevRMS</span></span>)</span>)</span> &gt; <span class="mxinfo" id="T2:U163">max(<span class="mxinfo" id="T4:U164">abs(<span class="mxinfo" id="T4:U165"><span class="mxinfo" id="T4:U166"><span class="var type1" id="S2T1U266">walkStruct</span>.Acur</span>-<span class="mxinfo" id="T4:U168"><span class="var type1" id="S2T1U269">walkStruct</span>.AcurRMS</span></span>)</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,64" id="srcline64">64</a></span><span class="line">                        <span class="keyword">if</span> <span class="mxinfo" id="T8:U170"><span class="mxinfo" id="T2:U171">max(<span class="mxinfo" id="T4:U172">abs(<span class="mxinfo" id="T4:U173"><span class="mxinfo" id="T4:U174"><span class="var type1" id="S2T1U280">walkStruct</span>.Acur</span>-<span class="mxinfo" id="T4:U176"><span class="var type1" id="S2T1U283">walkStruct</span>.AcurRMS</span></span>)</span>)</span> &gt; <span class="var type1" id="S8T2U285">HIth</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,65" id="srcline65">65</a></span><span class="line">                            <span class="mxinfo" id="T3:U179"><span class="mxinfo" id="T3:U180"><span class="var type1" id="S2T1U289">walkStruct</span>.HIcnt</span> = <span class="mxinfo" id="T3:U182"><span class="mxinfo" id="T3:U183"><span class="var type1" id="S2T1U293">walkStruct</span>.HIcnt</span> - <span class="mxinfo" id="T3:U185">uint32(<span class="mxinfo" id="T9:U186">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,66" id="srcline66">66</a></span><span class="line">                            <span class="mxinfo" id="T3:U187"><span class="mxinfo" id="T3:U188"><span class="var type1" id="S2T1U301">walkStruct</span>.HIt</span> = <span class="mxinfo" id="T3:U190"><span class="mxinfo" id="T3:U191"><span class="var type1" id="S2T1U305">walkStruct</span>.HIt</span> - <span class="mxinfo" id="T3:U193">uint32(<span class="mxinfo" id="T9:U194">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,67" id="srcline67">67</a></span><span class="line">                        <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,68" id="srcline68">68</a></span><span class="line">                            <span class="mxinfo" id="T3:U195"><span class="mxinfo" id="T3:U196"><span class="var type1" id="S2T1U314">walkStruct</span>.LIcnt</span> = <span class="mxinfo" id="T3:U198"><span class="mxinfo" id="T3:U199"><span class="var type1" id="S2T1U318">walkStruct</span>.LIcnt</span> - <span class="mxinfo" id="T3:U201">uint32(<span class="mxinfo" id="T9:U202">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,69" id="srcline69">69</a></span><span class="line">                            <span class="mxinfo" id="T3:U203"><span class="mxinfo" id="T3:U204"><span class="var type1" id="S2T1U326">walkStruct</span>.LIt</span> = <span class="mxinfo" id="T3:U206"><span class="mxinfo" id="T3:U207"><span class="var type1" id="S2T1U330">walkStruct</span>.LIt</span> - <span class="mxinfo" id="T3:U209">uint32(<span class="mxinfo" id="T9:U210">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,70" id="srcline70">70</a></span><span class="line">                        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,71" id="srcline71">71</a></span><span class="line">                        <span class="mxinfo" id="T4:U211"><span class="mxinfo" id="T4:U212"><span class="var type1" id="S2T1U338">walkStruct</span>.Acur</span> = <span class="mxinfo" id="T4:U214"><span class="var type1" id="S2T1U341">walkStruct</span>.Aprev</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,72" id="srcline72">72</a></span><span class="line">                        <span class="mxinfo" id="T4:U216"><span class="mxinfo" id="T4:U217"><span class="var type1" id="S2T1U346">walkStruct</span>.AcurRMS</span> = <span class="mxinfo" id="T4:U219"><span class="var type1" id="S2T1U349">walkStruct</span>.AprevRMS</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,73" id="srcline73">73</a></span><span class="line">                        <span class="mxinfo" id="T3:U221"><span class="mxinfo" id="T3:U222"><span class="var type1" id="S2T1U354">walkStruct</span>.Acurt</span> = <span class="mxinfo" id="T3:U224"><span class="var type1" id="S2T1U357">walkStruct</span>.Aprevt</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,74" id="srcline74">74</a></span><span class="line">                    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,75" id="srcline75">75</a></span><span class="line">                        <span class="keyword">if</span> <span class="mxinfo" id="T8:U226"><span class="mxinfo" id="T2:U227">max(<span class="mxinfo" id="T4:U228">abs(<span class="mxinfo" id="T4:U229"><span class="mxinfo" id="T4:U230"><span class="var type1" id="S2T1U369">walkStruct</span>.Aprev</span>-<span class="mxinfo" id="T4:U232"><span class="var type1" id="S2T1U372">walkStruct</span>.AprevRMS</span></span>)</span>)</span> &gt; <span class="var type1" id="S8T2U374">HIth</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,76" id="srcline76">76</a></span><span class="line">                            <span class="mxinfo" id="T3:U235"><span class="mxinfo" id="T3:U236"><span class="var type1" id="S2T1U378">walkStruct</span>.HIcnt</span> = <span class="mxinfo" id="T3:U238"><span class="mxinfo" id="T3:U239"><span class="var type1" id="S2T1U382">walkStruct</span>.HIcnt</span> - <span class="mxinfo" id="T3:U241">uint32(<span class="mxinfo" id="T9:U242">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,77" id="srcline77">77</a></span><span class="line">                            <span class="mxinfo" id="T3:U243"><span class="mxinfo" id="T3:U244"><span class="var type1" id="S2T1U390">walkStruct</span>.HIt</span> = <span class="mxinfo" id="T3:U246"><span class="mxinfo" id="T3:U247"><span class="var type1" id="S2T1U394">walkStruct</span>.HIt</span> - <span class="mxinfo" id="T3:U249">uint32(<span class="mxinfo" id="T9:U250">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,78" id="srcline78">78</a></span><span class="line">                        <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,79" id="srcline79">79</a></span><span class="line">                            <span class="mxinfo" id="T3:U251"><span class="mxinfo" id="T3:U252"><span class="var type1" id="S2T1U403">walkStruct</span>.LIcnt</span> = <span class="mxinfo" id="T3:U254"><span class="mxinfo" id="T3:U255"><span class="var type1" id="S2T1U407">walkStruct</span>.LIcnt</span> - <span class="mxinfo" id="T3:U257">uint32(<span class="mxinfo" id="T9:U258">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,80" id="srcline80">80</a></span><span class="line">                            <span class="mxinfo" id="T3:U259"><span class="mxinfo" id="T3:U260"><span class="var type1" id="S2T1U415">walkStruct</span>.LIt</span> = <span class="mxinfo" id="T3:U262"><span class="mxinfo" id="T3:U263"><span class="var type1" id="S2T1U419">walkStruct</span>.LIt</span> - <span class="mxinfo" id="T3:U265">uint32(<span class="mxinfo" id="T9:U266">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,81" id="srcline81">81</a></span><span class="line">                        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,82" id="srcline82">82</a></span><span class="line">                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,83" id="srcline83">83</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,84" id="srcline84">84</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,85" id="srcline85">85</a></span><span class="line">            <span class="comment">% set the current point as the previous point, and reset the</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,86" id="srcline86">86</a></span><span class="line">            <span class="comment">% current point for new steps.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,87" id="srcline87">87</a></span><span class="line">            <span class="mxinfo" id="T4:U267"><span class="mxinfo" id="T4:U268"><span class="var type1" id="S2T1U427">walkStruct</span>.Aprev</span> = <span class="mxinfo" id="T4:U270"><span class="var type1" id="S2T1U430">walkStruct</span>.Acur</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,88" id="srcline88">88</a></span><span class="line">            <span class="mxinfo" id="T4:U272"><span class="mxinfo" id="T4:U273"><span class="var type1" id="S2T1U435">walkStruct</span>.AprevRMS</span> = <span class="mxinfo" id="T4:U275"><span class="var type1" id="S2T1U438">walkStruct</span>.AcurRMS</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,89" id="srcline89">89</a></span><span class="line">            <span class="mxinfo" id="T3:U277"><span class="mxinfo" id="T3:U278"><span class="var type1" id="S2T1U443">walkStruct</span>.Aprevt</span> = <span class="mxinfo" id="T3:U280"><span class="var type1" id="S2T1U446">walkStruct</span>.Acurt</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,90" id="srcline90">90</a></span><span class="line">            <span class="mxinfo" id="T4:U282"><span class="mxinfo" id="T4:U283"><span class="var type1" id="S2T1U451">walkStruct</span>.Acur</span> = <span class="mxinfo" id="T4:U285">zeros(size(<span class="var type1" id="S2T1U458">walkStruct</span>.Acur),<span class="string">'single'</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,91" id="srcline91">91</a></span><span class="line">            <span class="mxinfo" id="T4:U287"><span class="mxinfo" id="T4:U288"><span class="var type1" id="S2T1U464">walkStruct</span>.AcurRMS</span> = <span class="mxinfo" id="T4:U290">zeros(size(<span class="var type1" id="S2T1U471">walkStruct</span>.AcurRMS),<span class="string">'single'</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,92" id="srcline92">92</a></span><span class="line">            <span class="mxinfo" id="T3:U292"><span class="mxinfo" id="T3:U293"><span class="var type1" id="S2T1U477">walkStruct</span>.Acurt</span> = <span class="mxinfo" id="T3:U295">uint32(<span class="mxinfo" id="T9:U296">0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,93" id="srcline93">93</a></span><span class="line">            <span class="mxinfo" id="T5:U297"><span class="mxinfo" id="T5:U298"><span class="var type1" id="S2T1U485">walkStruct</span>.crossed</span> = <span class="mxinfo" id="T5:U300">uint8(<span class="mxinfo" id="T9:U301">0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,94" id="srcline94">94</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,95" id="srcline95">95</a></span><span class="line">    <span class="keyword"><span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,96" id="srcline96">96</a></span><span class="line"><span class="comment">% end</span></span></span>
</pre>
